graph TB
    %% Detailed MasterHealthRecord Creation Flow
    %% Shows the specific data elements and transformations
    
    classDef healthData fill:#ffebee,stroke:#c62828,stroke-width:2px
    classDef geoData fill:#e3f2fd,stroke:#1565c0,stroke-width:2px
    classDef socioData fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef envData fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px
    classDef processor fill:#fff8e1,stroke:#f57c00,stroke-width:2px
    classDef masterRecord fill:#e8f5e8,stroke:#1b5e20,stroke-width:3px
    
    %% Source Data Components
    subgraph "AIHW Health Data Sources"
        MortalityData[Mortality Records<br/>â€¢ Cause of Death<br/>â€¢ Age-Standardised Rates<br/>â€¢ ICD-10 Codes<br/>â€¢ Geographic Mapping]
        HospitalData[Hospital Separations<br/>â€¢ Diagnosis Codes<br/>â€¢ Length of Stay<br/>â€¢ Service Types<br/>â€¢ Utilisation Rates]
        HealthIndicators[Health Indicators<br/>â€¢ Disease Prevalence<br/>â€¢ Risk Factors<br/>â€¢ Screening Rates<br/>â€¢ Health Behaviours]
        MedicareUtil[Medicare Utilisation<br/>â€¢ GP Services<br/>â€¢ Specialist Care<br/>â€¢ Bulk Billing Rates<br/>â€¢ Per Capita Usage]
    end
    
    subgraph "ABS Demographic & Geographic Data"
        SA2Boundaries[SA2 Boundaries<br/>â€¢ Geometric Data<br/>â€¢ Area Calculations<br/>â€¢ Coordinate Systems<br/>â€¢ Geographic Hierarchy]
        CensusDemo[Census Demographics<br/>â€¢ Population Counts<br/>â€¢ Age/Sex Distribution<br/>â€¢ Household Income<br/>â€¢ Employment Status]
        SEIFAIndices[SEIFA Indices<br/>â€¢ Disadvantage (IRSD)<br/>â€¢ Advantage (IRSAD)<br/>â€¢ Economic Resources (IER)<br/>â€¢ Education/Occupation (IEO)]
        PostcodeMaps[Postcode Mappings<br/>â€¢ Correspondence Files<br/>â€¢ Geographic Linkages<br/>â€¢ Address Validation]
    end
    
    subgraph "BOM Environmental Data"
        ClimateData[Climate Observations<br/>â€¢ Temperature Records<br/>â€¢ Rainfall Data<br/>â€¢ Humidity Levels<br/>â€¢ Solar Exposure]
        WeatherStations[Weather Stations<br/>â€¢ Station Metadata<br/>â€¢ Geographic Coverage<br/>â€¢ Data Quality Flags]
        AirQuality[Environmental Indicators<br/>â€¢ Air Quality Index<br/>â€¢ UV Exposure<br/>â€¢ Heat Stress Indicators]
    end
    
    %% Processing Stages
    subgraph "Data Integration Processors"
        SA2Aggregator[SA2 Data Aggregator<br/>â€¢ Geographic Harmonisation<br/>â€¢ Spatial Joins<br/>â€¢ Population Weighting<br/>â€¢ Statistical Aggregation]
        
        HealthCalculator[Health Indicator Calculator<br/>â€¢ Rate Standardisation<br/>â€¢ Confidence Intervals<br/>â€¢ Trend Analysis<br/>â€¢ Risk Assessment]
        
        DemoBuilder[Demographic Profile Builder<br/>â€¢ Population Pyramids<br/>â€¢ Household Composition<br/>â€¢ Economic Indicators<br/>â€¢ Social Characteristics]
        
        QualityCalculator[Quality Score Calculator<br/>â€¢ Data Completeness<br/>â€¢ Source Reliability<br/>â€¢ Temporal Currency<br/>â€¢ Spatial Accuracy]
    end
    
    %% MasterHealthRecord Components
    subgraph "MasterHealthRecord Structure"
        PrimaryID[Primary Identification<br/>â€¢ SA2 Code (9 digits)<br/>â€¢ SA2 Name<br/>â€¢ Data Version<br/>â€¢ Last Updated]
        
        GeographicDims[Geographic Dimensions<br/>â€¢ Boundary Geometry<br/>â€¢ Area (sq km)<br/>â€¢ Urban/Rural Classification<br/>â€¢ Remoteness Category<br/>â€¢ Geographic Hierarchy]
        
        DemographicProfile[Demographic Profile<br/>â€¢ Total Population<br/>â€¢ Population Density<br/>â€¢ Age Distribution<br/>â€¢ Household Characteristics<br/>â€¢ Economic Indicators]
        
        HealthProfile[Health Profile<br/>â€¢ Mortality Indicators<br/>â€¢ Disease Prevalence<br/>â€¢ Healthcare Utilisation<br/>â€¢ Health Risk Factors<br/>â€¢ Service Access]
        
        SocioeconomicProfile[Socioeconomic Profile<br/>â€¢ SEIFA Scores<br/>â€¢ Income Distribution<br/>â€¢ Education Levels<br/>â€¢ Employment Patterns<br/>â€¢ Social Disadvantage]
        
        EnvironmentalProfile[Environmental Profile<br/>â€¢ Climate Indicators<br/>â€¢ Air Quality Metrics<br/>â€¢ Environmental Health Risks<br/>â€¢ Weather Patterns]
        
        QualityMetadata[Data Quality Metadata<br/>â€¢ Integration Level<br/>â€¢ Quality Scores<br/>â€¢ Source Tracking<br/>â€¢ Audit Trail<br/>â€¢ Validation Results]
    end
    
    %% Final Master Record
    FinalMaster[ðŸŽ¯ Complete MasterHealthRecord<br/>â€¢ Comprehensive SA2 Profile<br/>â€¢ Multi-dimensional Health Data<br/>â€¢ Quality Assured<br/>â€¢ Export Ready]
    
    %% Data Flows
    MortalityData --> SA2Aggregator
    HospitalData --> SA2Aggregator
    HealthIndicators --> HealthCalculator
    MedicareUtil --> HealthCalculator
    
    SA2Boundaries --> SA2Aggregator
    CensusDemo --> DemoBuilder
    SEIFAIndices --> DemoBuilder
    PostcodeMaps --> SA2Aggregator
    
    ClimateData --> SA2Aggregator
    WeatherStations --> SA2Aggregator
    AirQuality --> SA2Aggregator
    
    SA2Aggregator --> PrimaryID
    SA2Aggregator --> GeographicDims
    
    HealthCalculator --> HealthProfile
    DemoBuilder --> DemographicProfile
    DemoBuilder --> SocioeconomicProfile
    
    SA2Aggregator --> EnvironmentalProfile
    QualityCalculator --> QualityMetadata
    
    PrimaryID --> FinalMaster
    GeographicDims --> FinalMaster
    DemographicProfile --> FinalMaster
    HealthProfile --> FinalMaster
    SocioeconomicProfile --> FinalMaster
    EnvironmentalProfile --> FinalMaster
    QualityMetadata --> FinalMaster
    
    %% Apply Styles
    class MortalityData,HospitalData,HealthIndicators,MedicareUtil healthData
    class SA2Boundaries,CensusDemo,SEIFAIndices,PostcodeMaps geoData
    class ClimateData,WeatherStations,AirQuality envData
    class SA2Aggregator,HealthCalculator,DemoBuilder,QualityCalculator processor
    class PrimaryID,GeographicDims,DemographicProfile,HealthProfile,SocioeconomicProfile,EnvironmentalProfile,QualityMetadata,FinalMaster masterRecord